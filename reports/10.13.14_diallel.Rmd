---
title: "Diallel Research Report One"
author: "Jinliang Yang"
date: "October 13th, 2014"
output: rmarkdown::tufte_handout
---

\begin{abstract}
One purpose of this manual is to document research progress and to facilitate communication. I try to make this \textbf{pvpDiallel} project completely reproducible with the help of some R packages. The dependencies in this project are managed by \textbf{Packrat}. It enables the collaborator to run it immediately after cloning this repo without installing anything. Because some of the work is time consuming, I tend to turn off these code chunks that need heavy computational power. But you could still find the source codes or their paths in this report. This document itself was generated in \textbf{Rstudio} using \textbf{rmarkdown} with the \textbf{tufte\_handout} output format. 
\end{abstract}


```{r setup}
# set up the project and global enviroment
library(knitr)
opts_knit$set(root.dir=normalizePath('../'))
```

# Phenotypic data

The phenotypic data _per se_, GCA and SCA was reformatted from Sofiane's files and transformed them to a data matrix. The following chunk of code could not be re-ran because data from external folders were loaded. The original phenotypic data could be found here 
`/group/jrigrp2/DiallelSofiane/GeneticValues/` on `farm`. 

```{r, eval=F}
### data per se, GCA and SCA
source("munge/1.raw_pheno/1.A.1_format_pheno.R")
source("munge/1.raw_pheno/1.A.2_format_gca_sca.R")
```

## plot the phentoypic data _per se_

```{r, fig.width = 10, fig.height = 3, fig.fullwidth = TRUE, fig.cap = "phenotypic data distribution"}
source("profiling/1.pheno/1.A.1_pheno_plot.R")
```

From Figure 1, the phenotypic values of seven traits were bell-shape distributed. After normality tests using `shapiro.test`, the p-value for the first trait __ASI__ was a little bit above 0.05 and all the others are >>0.05. These normality test p-values are: `r round(res, 3)`. Generally, we do not have evidences to reject the normal distribution of these phenotypes. And, the trait values may not need to be transformed. 

## Levels of heterosis of the seven traits
As reported by Flint-Garcia _et al_ [^r1] and observed by my previous studies, the levels of heterosis are varied. The variation of the levels of heterosis was also observed in the current study using both pMPH and pBPH. Interestingly, __ASI__ showed a negative heterosis; __DTS__, __DTP__ and __TW__ exhibited almost no heterosis; __PHT__ and __EHT__ exhibited moderate levels of heterosis; and __GY__ exhibited very strong heterosis.

```{r,  fig.width = 10, fig.height = 5, fig.fullwidth = TRUE, fig.cap = "Variation of the levels of heterosis"}
source("profiling/1.pheno/1.A.2_pheno_loh_plot.R")

```

## Correlation of the seven phenotypic traits

```{r, fig.width = 4, fig.height = 4, fig.cap = "Correlation plot of the seven traits"}
source("profiling/1.pheno/1.A.3_pheno_cor_plot.R")
### get the pheno per se
myp1 <- get_pheno(trait=trait, pheno="valHyb")
pairs(myp1[, 2:8], text.panel = diag, upper.panel=panel.smooth, 
      lower.panel=panel.cor, gap=0, main="", pch=19, col="grey", lwd=2)
```

In the Figure 3, correlations of trait _per se_ were plotted with the above codes. For the Figure 4 and Figure 5, similar codes were used but not shown in this report.

As shown in Figure 3, __DTS__ vs. __DTP__ and __PHT__ vs. __EHT__ were highly positively correlated. These positive correlations were also hold for pBPH and pMPH. While, the trait values _per se_ of __ASI__ negatively correlated with __DTS__. However, the negative correlation become not statistically significant for pBPH and pMPH of the pairs of the traits. With the correlation of these traits, we expect to find some shared trait-associated variants after GWAS.    


```{r, echo=FALSE, fig.width = 4, fig.height = 4, fig.cap = "Correlation plot of pBPHmax"}
source("profiling/1.pheno/1.A.3_pheno_cor_plot.R")
### get percentage of BPHmax
myp2 <- get_pheno(trait=trait, pheno="pBPHmax")
pairs(myp2[, 2:8], text.panel = diag, upper.panel=panel.smooth, 
      lower.panel=panel.cor, gap=0, main="", pch=19, col="grey", lwd=2)

```


```{r, echo=FALSE, fig.width = 4, fig.height = 4, fig.cap = "Correlation plot of pMPH"}
source("profiling/1.pheno/1.A.3_pheno_cor_plot.R")
### get percentage of BPHmax
myp3 <- get_pheno(trait=trait, pheno="pMPH")
pairs(myp3[, 2:8], text.panel = diag, upper.panel=panel.smooth, 
      lower.panel=panel.cor, gap=0, main="", pch=19, col="grey", lwd=2)

```

# general combining ability of the traits



```{r, results='asis'}
library(xtable)
source("profiling/1.pheno/1.B.1_GCA_table.R")
options(xtable.comment = FALSE)
options(xtable.booktabs = TRUE)
xtable(GCA, caption = "General combining abilities of the seven traits")
```


[^r1]: Flint-Garcia SA, Buckler ES, Tiffin P, Ersoz E, Springer NM (2009) Heterosis Is Prevalent for Multiple Traits in Diverse Maize Germplasm. PLoS ONE 4(10): e7433. doi:10.1371/journal.pone.0007433








